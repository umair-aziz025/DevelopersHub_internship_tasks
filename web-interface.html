<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybersecurity Internship - Web App Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            color: #2c3e50;
            margin-bottom: 10px;
            font-size: 2.5em;
        }
        
        .header p {
            color: #7f8c8d;
            font-size: 1.2em;
        }
        
        .server-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .server-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            transition: transform 0.3s ease;
        }
        
        .server-card:hover {
            transform: translateY(-5px);
        }
        
        .server-card h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #27ae60;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .server-info {
            margin-bottom: 20px;
        }
        
        .server-info p {
            margin: 5px 0;
            color: #555;
        }
        
        .endpoint-list {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .endpoint-list h4 {
            color: #2c3e50;
            margin-bottom: 10px;
        }
        
        .endpoint {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 8px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .endpoint:last-child {
            border-bottom: none;
        }
        
        .endpoint code {
            background: #e9ecef;
            padding: 4px 8px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }
        
        .test-btn {
            background: #3498db;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
            font-size: 0.8em;
        }
        
        .test-btn:hover {
            background: #2980b9;
        }
        
        .demo-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
        }
        
        .demo-section h2 {
            color: #2c3e50;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .auth-form {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
        }
        
        .form-group label {
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .form-group input {
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 5px;
            font-size: 1em;
        }
        
        .form-group input:focus {
            outline: none;
            border-color: #3498db;
        }
        
        .btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: background 0.3s ease;
        }
        
        .btn:hover {
            background: #229954;
        }
        
        .btn-secondary {
            background: #95a5a6;
        }
        
        .btn-secondary:hover {
            background: #7f8c8d;
        }
        
        .response-area {
            background: #2c3e50;
            color: #ecf0f1;
            border-radius: 8px;
            padding: 15px;
            margin-top: 15px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .security-badge {
            display: inline-block;
            background: #e74c3c;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8em;
            margin: 2px;
        }
        
        .security-badge.secure {
            background: #27ae60;
        }
        
        .security-badge.advanced {
            background: #8e44ad;
        }
        
        .security-badge.enterprise {
            background: #f39c12;
        }
        
        @media (max-width: 768px) {
            .auth-form {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔒 DevelopersHub Cybersecurity Internship</h1>
            <p>6-Week Complete Security Implementation Journey</p>
            <p><strong>From Vulnerable to Enterprise-Ready Security</strong></p>
        </div>

        <div class="server-grid">
            <!-- Week 1: Vulnerable Server -->
            <div class="server-card">
                <h3>
                    <span class="status-indicator" style="background: #e74c3c;"></span>
                    Week 1: Vulnerable Server
                </h3>
                <div class="server-info">
                    <p><strong>Port:</strong> 3000</p>
                    <p><strong>Purpose:</strong> Educational vulnerabilities</p>
                    <p><strong>Security Level:</strong> <span class="security-badge">Vulnerable</span></p>
                </div>
                <div class="endpoint-list">
                    <h4>Available Endpoints:</h4>
                    <div class="endpoint">
                        <code>GET /health</code>
                        <button class="test-btn" onclick="testEndpoint('http://localhost:3000/health')">Test</button>
                    </div>
                    <div class="endpoint">
                        <code>POST /api/login</code>
                        <button class="test-btn" onclick="testVulnerableLogin()">Test</button>
                    </div>
                    <div class="endpoint">
                        <code>POST /api/signup</code>
                        <button class="test-btn" onclick="showInfo('Vulnerable signup endpoint')">Info</button>
                    </div>
                </div>
            </div>

            <!-- Week 2-3: Secure Server -->
            <div class="server-card">
                <h3>
                    <span class="status-indicator" style="background: #27ae60;"></span>
                    Week 2-3: Secure Server
                </h3>
                <div class="server-info">
                    <p><strong>Port:</strong> 3001</p>
                    <p><strong>Purpose:</strong> Basic security implementation</p>
                    <p><strong>Security Level:</strong> <span class="security-badge secure">Secure</span></p>
                </div>
                <div class="endpoint-list">
                    <h4>Available Endpoints:</h4>
                    <div class="endpoint">
                        <code>GET /health</code>
                        <button class="test-btn" onclick="testEndpoint('http://localhost:3001/health')">Test</button>
                    </div>
                    <div class="endpoint">
                        <code>POST /api/secure-login</code>
                        <button class="test-btn" onclick="testSecureLogin()">Test</button>
                    </div>
                    <div class="endpoint">
                        <code>GET /api/profile</code>
                        <button class="test-btn" onclick="showInfo('Requires authentication')">Info</button>
                    </div>
                </div>
            </div>

            <!-- Week 5: Ethical Hacking Server -->
            <div class="server-card">
                <h3>
                    <span class="status-indicator" style="background: #8e44ad;"></span>
                    Week 5: Ethical Hacking
                </h3>
                <div class="server-info">
                    <p><strong>Port:</strong> 3002</p>
                    <p><strong>Purpose:</strong> Professional testing validation</p>
                    <p><strong>Security Level:</strong> <span class="security-badge advanced">Advanced</span></p>
                </div>
                <div class="endpoint-list">
                    <h4>Available Endpoints:</h4>
                    <div class="endpoint">
                        <code>GET /api/week5/status</code>
                        <button class="test-btn" onclick="testEndpoint('http://localhost:3002/api/week5/status')">Test</button>
                    </div>
                    <div class="endpoint">
                        <code>GET /api/csrf-token</code>
                        <button class="test-btn" onclick="testEndpoint('http://localhost:3002/api/csrf-token')">Test</button>
                    </div>
                </div>
            </div>

            <!-- Week 6: Production Server -->
            <div class="server-card">
                <h3>
                    <span class="status-indicator" style="background: #f39c12;"></span>
                    Week 6: Production Ready
                </h3>
                <div class="server-info">
                    <p><strong>Port:</strong> 3003</p>
                    <p><strong>Purpose:</strong> Enterprise deployment</p>
                    <p><strong>Security Level:</strong> <span class="security-badge enterprise">Enterprise</span></p>
                </div>
                <div class="endpoint-list">
                    <h4>Available Endpoints:</h4>
                    <div class="endpoint">
                        <code>GET /health</code>
                        <button class="test-btn" onclick="testEndpoint('http://localhost:3003/health')">Test</button>
                    </div>
                    <div class="endpoint">
                        <code>GET /api/production/status</code>
                        <button class="test-btn" onclick="testEndpoint('http://localhost:3003/api/production/status')">Test</button>
                    </div>
                    <div class="endpoint">
                        <code>GET /api/csrf-token</code>
                        <button class="test-btn" onclick="testEndpoint('http://localhost:3003/api/csrf-token')">Test</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Interactive Demo Section -->
        <div class="demo-section">
            <h2>🧪 Interactive Security Demo</h2>
            
            <div class="auth-form">
                <div class="form-group">
                    <label for="server-select">Select Server:</label>
                    <select id="server-select">
                        <option value="3000">Week 1 - Vulnerable (Port 3000)</option>
                        <option value="3001">Week 2-3 - Secure (Port 3001)</option>
                        <option value="3002">Week 5 - Ethical Hacking (Port 3002)</option>
                        <option value="3003" selected>Week 6 - Production (Port 3003)</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="endpoint-select">Select Endpoint:</label>
                    <select id="endpoint-select">
                        <option value="/health">Health Check</option>
                        <option value="/api/production/status">Production Status</option>
                        <option value="/api/csrf-token">CSRF Token</option>
                    </select>
                </div>
            </div>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <button class="btn" onclick="makeRequest()">🚀 Make Request</button>
                <button class="btn btn-secondary" onclick="clearResponse()">🗑️ Clear</button>
            </div>
            
            <div class="response-area" id="response-area">Click "Make Request" to test endpoints...</div>
        </div>

        <!-- Authentication Demo -->
        <div class="demo-section">
            <h2>🔐 Authentication Demo (Production Server)</h2>
            
            <div class="auth-form">
                <div class="form-group">
                    <label for="username">Username:</label>
                    <input type="text" id="username" value="john" placeholder="Enter username">
                </div>
                <div class="form-group">
                    <label for="password">Password:</label>
                    <input type="password" id="password" value="MySecure123" placeholder="Enter password">
                </div>
            </div>
            
            <div style="text-align: center; margin-bottom: 20px;">
                <button class="btn" onclick="authenticateUser()">🔑 Login</button>
                <button class="btn" onclick="registerTestUser()" style="background: #27ae60; margin-left: 10px;">📝 Register Test User</button>
                <button class="btn btn-secondary" onclick="getUserProfile()">👤 Get Profile</button>
            </div>
            
            <div class="response-area" id="auth-response">Authentication responses will appear here...</div>
        </div>
    </div>

    <script>
        let authToken = null;
        let csrfToken = null;

        async function testEndpoint(url) {
            const responseArea = document.getElementById('response-area');
            responseArea.textContent = 'Loading...';
            
            try {
                const response = await fetch(url, {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const data = await response.json();
                responseArea.textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                responseArea.textContent = 'Error: ' + error.message + '\n\nTip: Make sure the server on that port is running!';
            }
        }

        async function makeRequest() {
            const server = document.getElementById('server-select').value;
            const endpoint = document.getElementById('endpoint-select').value;
            const url = `http://localhost:${server}${endpoint}`;
            
            await testEndpoint(url);
        }

        function clearResponse() {
            document.getElementById('response-area').textContent = 'Cleared. Ready for new request...';
        }

        async function authenticateUser() {
            const responseArea = document.getElementById('auth-response');
            responseArea.textContent = 'Authenticating...';
            
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            console.log('Starting authentication with:', { username, passwordLength: password.length });
            
            try {
                responseArea.textContent = 'Step 1: Getting CSRF token...';
                
                // First get CSRF token
                const csrfResponse = await fetch('http://localhost:3003/api/csrf-token', {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                console.log('CSRF Response status:', csrfResponse.status);
                
                if (!csrfResponse.ok) {
                    const csrfError = await csrfResponse.text();
                    console.error('CSRF Error:', csrfError);
                    throw new Error(`CSRF fetch failed: ${csrfResponse.status} - ${csrfError}`);
                }
                
                const csrfData = await csrfResponse.json();
                csrfToken = csrfData.csrfToken;
                console.log('Got CSRF token:', csrfToken ? 'Yes' : 'No');
                
                responseArea.textContent = 'Step 2: Attempting login with credentials...';
                
                // Prepare login data
                const loginData = { 
                    username: username, 
                    password: password
                };
                
                console.log('Login data prepared:', { username: loginData.username, passwordLength: loginData.password.length });
                
                // Then authenticate
                const response = await fetch('http://localhost:3003/api/auth/login', {
                    method: 'POST',
                    mode: 'cors',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-Token': csrfToken,
                        'CSRF-Token': csrfToken
                    },
                    body: JSON.stringify(loginData)
                });
                
                console.log('Login Response status:', response.status);
                console.log('Login Response headers:', [...response.headers.entries()]);
                
                const responseText = await response.text();
                console.log('Login Response text:', responseText);
                
                if (!response.ok) {
                    let errorData;
                    try {
                        errorData = JSON.parse(responseText);
                    } catch {
                        errorData = { error: responseText };
                    }
                    throw new Error(`Login failed: ${response.status} ${response.statusText} - ${errorData.error || responseText}`);
                }
                
                const data = JSON.parse(responseText);
                
                if (data.token) {
                    authToken = data.token;
                    responseArea.textContent = '✅ Authentication successful!\n\n' + JSON.stringify(data, null, 2);
                } else {
                    responseArea.textContent = '❌ Authentication failed!\n\n' + JSON.stringify(data, null, 2);
                }
            } catch (error) {
                console.error('Authentication error:', error);
                responseArea.textContent = '❌ Error: ' + error.message + '\n\nCheck browser console for detailed logs.\n\nTip: Make sure the production server (port 3003) is running!';
            }
        }

        async function registerTestUser() {
            const responseArea = document.getElementById('auth-response');
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            
            responseArea.textContent = 'Registering new user...';
            
            try {
                // First get CSRF token
                const csrfResponse = await fetch('http://localhost:3003/api/csrf-token', {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                    }
                });
                
                if (!csrfResponse.ok) {
                    throw new Error(`CSRF fetch failed: ${csrfResponse.status}`);
                }
                
                const csrfData = await csrfResponse.json();
                const registrationCsrfToken = csrfData.csrfToken;
                
                // Register user
                const response = await fetch('http://localhost:3003/api/auth/register', {
                    method: 'POST',
                    mode: 'cors',
                    credentials: 'include',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRF-Token': registrationCsrfToken,
                        'CSRF-Token': registrationCsrfToken
                    },
                    body: JSON.stringify({
                        username: username,
                        email: `${username}@test.com`,
                        password: password,
                        profile_info: 'Test user created from web interface'
                    })
                });
                
                const responseText = await response.text();
                
                if (!response.ok) {
                    let errorData;
                    try {
                        errorData = JSON.parse(responseText);
                    } catch {
                        errorData = { error: responseText };
                    }
                    throw new Error(`Registration failed: ${response.status} - ${errorData.error || responseText}`);
                }
                
                const data = JSON.parse(responseText);
                responseArea.textContent = '✅ User registered successfully!\n\n' + JSON.stringify(data, null, 2) + '\n\nNow you can login with these credentials.';
                
            } catch (error) {
                console.error('Registration error:', error);
                responseArea.textContent = '❌ Registration Error: ' + error.message;
            }
        }

        async function getUserProfile() {
            const responseArea = document.getElementById('auth-response');
            
            if (!authToken) {
                responseArea.textContent = '❌ Please login first to get authentication token.';
                return;
            }
            
            responseArea.textContent = 'Getting user profile...';
            
            try {
                const response = await fetch('http://localhost:3003/api/user/profile', {
                    method: 'GET',
                    mode: 'cors',
                    credentials: 'include',
                    headers: {
                        'Authorization': `Bearer ${authToken}`,
                        'Content-Type': 'application/json'
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`Profile fetch failed: ${response.status} ${response.statusText}`);
                }
                
                const data = await response.json();
                responseArea.textContent = '✅ User Profile:\n\n' + JSON.stringify(data, null, 2);
            } catch (error) {
                responseArea.textContent = '❌ Error: ' + error.message + '\n\nTip: Make sure you are authenticated and the server is running!';
            }
        }

        function testVulnerableLogin() {
            showInfo('Vulnerable login can be tested with SQL injection payloads like: admin\' OR \'1\'=\'1');
        }

        function testSecureLogin() {
            showInfo('Secure login requires proper credentials and CSRF protection.');
        }

        function showInfo(message) {
            document.getElementById('response-area').textContent = 'ℹ️ ' + message;
        }

        // Update endpoint options based on server selection
        document.getElementById('server-select').addEventListener('change', function() {
            const server = this.value;
            const endpointSelect = document.getElementById('endpoint-select');
            
            endpointSelect.innerHTML = '';
            
            const endpoints = {
                '3000': [
                    {value: '/health', text: 'Health Check'},
                    {value: '/api/login', text: 'Login (Vulnerable)'},
                    {value: '/api/signup', text: 'Signup'}
                ],
                '3001': [
                    {value: '/health', text: 'Health Check'},
                    {value: '/api/secure-login', text: 'Secure Login'},
                    {value: '/api/profile', text: 'User Profile'}
                ],
                '3002': [
                    {value: '/api/week5/status', text: 'Week 5 Status'},
                    {value: '/api/csrf-token', text: 'CSRF Token'},
                    {value: '/health', text: 'Health Check'}
                ],
                '3003': [
                    {value: '/health', text: 'Health Check'},
                    {value: '/api/production/status', text: 'Production Status'},
                    {value: '/api/csrf-token', text: 'CSRF Token'},
                    {value: '/api/security/metrics', text: 'Security Metrics (Admin)'}
                ]
            };
            
            endpoints[server].forEach(endpoint => {
                const option = document.createElement('option');
                option.value = endpoint.value;
                option.textContent = endpoint.text;
                endpointSelect.appendChild(option);
            });
        });

        // Initialize endpoint options
        document.getElementById('server-select').dispatchEvent(new Event('change'));
    </script>
</body>
</html>
